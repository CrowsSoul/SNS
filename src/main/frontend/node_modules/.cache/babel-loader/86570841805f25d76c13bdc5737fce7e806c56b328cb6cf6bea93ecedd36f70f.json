{"ast":null,"code":"import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-7afde984\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  key: 0,\n  class: \"activity-detail\"\n};\nconst _hoisted_2 = {\n  class: \"action-buttons\"\n};\nconst _hoisted_3 = {\n  key: 0,\n  class: \"report-success\"\n};\nconst _hoisted_4 = {\n  class: \"report-success-box\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"confirm-buttons\"\n};\nconst _hoisted_6 = {\n  key: 1,\n  class: \"report-success\"\n};\nconst _hoisted_7 = {\n  class: \"report-success-box\"\n};\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \"报名成功\", -1 /* HOISTED */));\nconst _hoisted_9 = {\n  key: 1\n};\nconst _hoisted_10 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \"加载中...\", -1 /* HOISTED */));\nconst _hoisted_11 = [_hoisted_10];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return $data.activity ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"h1\", null, _toDisplayString($data.activity.name), 1 /* TEXT */), _createElementVNode(\"p\", null, \"时间: \" + _toDisplayString($options.formatDate($data.activity.time)), 1 /* TEXT */), _createElementVNode(\"p\", null, \"地点: \" + _toDisplayString($data.activity.location), 1 /* TEXT */), _createElementVNode(\"p\", null, \" 报名人数: \" + _toDisplayString($data.activity.currentParticipants) + \"/\" + _toDisplayString($data.activity.maxParticipants), 1 /* TEXT */), _createElementVNode(\"p\", null, \"简介: \" + _toDisplayString($data.activity.description), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.goBack && $options.goBack(...args)),\n    class: \"back-button\"\n  }, \"返回\"), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.confirmRegister && $options.confirmRegister(...args)),\n    class: \"register-button\"\n  }, \"报名\")]), $data.showConfirm ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"p\", null, _toDisplayString($data.confirmMessage), 1 /* TEXT */), $data.confirmMessage === '您已报名过了！' ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.cancelRegister && $options.cancelRegister(...args)),\n    class: \"confirm-button\"\n  }, \" 确定 \")) : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.executeRegister && $options.executeRegister(...args)),\n    class: \"confirm-button\"\n  }, \"确认\"), _createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = (...args) => $options.cancelRegister && $options.cancelRegister(...args)),\n    class: \"confirm-button cancel-button\"\n  }, \" 取消 \")]))])])) : _createCommentVNode(\"v-if\", true), $data.showSuccess ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_hoisted_8, _createElementVNode(\"button\", {\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.closeSuccess && $options.closeSuccess(...args)),\n    class: \"confirm-button\"\n  }, \"确定\")])])) : _createCommentVNode(\"v-if\", true)])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [..._hoisted_11]));\n}","map":{"version":3,"names":["key","class","_createElementVNode","_hoisted_10","$data","activity","_createElementBlock","_hoisted_1","_toDisplayString","name","$options","formatDate","time","location","currentParticipants","maxParticipants","description","_hoisted_2","onClick","_cache","args","goBack","confirmRegister","showConfirm","_hoisted_3","_hoisted_4","confirmMessage","cancelRegister","_hoisted_5","executeRegister","_createCommentVNode","showSuccess","_hoisted_6","_hoisted_7","_hoisted_8","closeSuccess","_hoisted_9","_hoisted_11"],"sources":["D:\\Code\\Project\\SNSproject\\SNS\\src\\main\\frontend\\src\\views\\activity\\user\\ActivityDetail.vue"],"sourcesContent":["<template>\r\n  <div class=\"activity-detail\" v-if=\"activity\">\r\n    <h1>{{ activity.name }}</h1>\r\n    <p>时间: {{ formatDate(activity.time) }}</p>\r\n    <p>地点: {{ activity.location }}</p>\r\n    <p>\r\n      报名人数: {{ activity.currentParticipants }}/{{\r\n        activity.maxParticipants\r\n      }}\r\n    </p>\r\n    <p>简介: {{ activity.description }}</p>\r\n    <div class=\"action-buttons\">\r\n      <button @click=\"goBack\" class=\"back-button\">返回</button>\r\n      <button @click=\"confirmRegister\" class=\"register-button\">报名</button>\r\n    </div>\r\n    <div v-if=\"showConfirm\" class=\"report-success\">\r\n      <div class=\"report-success-box\">\r\n        <p>{{ confirmMessage }}</p>\r\n        <button\r\n          v-if=\"confirmMessage === '您已报名过了！'\"\r\n          @click=\"cancelRegister\"\r\n          class=\"confirm-button\"\r\n        >\r\n          确定\r\n        </button>\r\n        <div v-else class=\"confirm-buttons\">\r\n          <button @click=\"executeRegister\" class=\"confirm-button\">确认</button>\r\n          <button @click=\"cancelRegister\" class=\"confirm-button cancel-button\">\r\n            取消\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div v-if=\"showSuccess\" class=\"report-success\">\r\n      <div class=\"report-success-box\">\r\n        <p>报名成功</p>\r\n        <button @click=\"closeSuccess\" class=\"confirm-button\">确定</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div v-else>\r\n    <p>加载中...</p>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"@/utils/axios\";\r\n\r\nexport default {\r\n  name: \"ActivityDetail\",\r\n  data() {\r\n    return {\r\n      activity: null,\r\n      user: null,\r\n      showConfirm: false,\r\n      showSuccess: false,\r\n      confirmMessage: \"\",\r\n    };\r\n  },\r\n  methods: {\r\n    async fetchActivity() {\r\n      try {\r\n        const response = await axios.get(\r\n          `/activities/${this.$route.params.id}`\r\n        );\r\n        this.activity = response.data;\r\n      } catch (error) {\r\n        console.error(\"获取活动详情失败\", error);\r\n      }\r\n    },\r\n    goBack() {\r\n      const from = this.$route.query.from;\r\n      if (from === \"preparing\") {\r\n        this.$router.push({\r\n          name: \"ActivityPreparing\",\r\n          query: { page: this.$route.query.page },\r\n        });\r\n      } else {\r\n        this.$router.push({\r\n          name: \"ActivityHall\",\r\n          query: { page: this.$route.query.page },\r\n        });\r\n      }\r\n    },\r\n    setMenu() {\r\n      this.$store.dispatch(\"setActiveSubMenu\", \"activity\");\r\n    },\r\n    formatDate(timeArray) {\r\n      return `${timeArray[0]}-${timeArray[1]}-${timeArray[2]} ${timeArray[3]\r\n        .toString()\r\n        .padStart(2, \"0\")}:${timeArray[4].toString().padStart(2, \"0\")}`;\r\n    },\r\n    confirmRegister() {\r\n      if (this.activity && this.user) {\r\n        if (this.activity.participantList.includes(this.user.nickname)) {\r\n          this.confirmMessage = \"您已报名过了！\";\r\n        } else if (\r\n          this.activity.currentParticipants >= this.activity.maxParticipants\r\n        ) {\r\n          this.confirmMessage = \"报名人数已满！\";\r\n        } else {\r\n          this.confirmMessage = \"确定要报名参加此活动吗？\";\r\n        }\r\n        this.showConfirm = true;\r\n      }\r\n    },\r\n    async executeRegister() {\r\n      if (this.confirmMessage === \"确定要报名参加此活动吗？\") {\r\n        this.activity.currentParticipants += 1;\r\n        this.activity.participantList.push(this.user.nickname);\r\n        try {\r\n          await axios.put(`/activities/${this.activity.id}`, this.activity);\r\n          this.showSuccess = true;\r\n        } catch (error) {\r\n          console.error(\"报名失败\", error);\r\n        }\r\n      }\r\n      this.showConfirm = false;\r\n    },\r\n    cancelRegister() {\r\n      this.showConfirm = false;\r\n    },\r\n    closeSuccess() {\r\n      this.showSuccess = false;\r\n    },\r\n  },\r\n  created() {\r\n    this.fetchActivity();\r\n    this.setMenu();\r\n    const userData = localStorage.getItem(\"user\");\r\n    if (userData) {\r\n      this.user = JSON.parse(userData);\r\n    }\r\n  },\r\n  watch: {\r\n    $route() {\r\n      this.setMenu();\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.activity-detail {\r\n  padding: 20px;\r\n  background: #f9f9f9;\r\n  border-radius: 10px;\r\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.activity-detail h1 {\r\n  margin-top: 0;\r\n}\r\n\r\n.activity-detail p {\r\n  margin: 10px 0;\r\n}\r\n\r\n.action-buttons {\r\n  margin-top: 20px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.back-button,\r\n.register-button {\r\n  padding: 10px 20px;\r\n  background-color: #42b983;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  font-size: 16px;\r\n  transition: background 0.3s;\r\n}\r\n\r\n.back-button:hover,\r\n.register-button:hover {\r\n  background-color: #358a66;\r\n}\r\n\r\n.register-button {\r\n  background-color: #f0ad4e;\r\n}\r\n\r\n.register-button:hover {\r\n  background-color: #ec971f;\r\n}\r\n\r\n.report-success {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.8);\r\n  color: white;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.report-success-box {\r\n  background: #2c3e50;\r\n  padding: 40px;\r\n  border-radius: 30px;\r\n  text-align: center;\r\n  width: 400px;\r\n}\r\n\r\n.confirm-button {\r\n  padding: 15px 30px;\r\n  background-color: #42b983;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 10px;\r\n  cursor: pointer;\r\n  margin-top: 20px;\r\n  font-size: 16px;\r\n}\r\n\r\n.confirm-button:hover {\r\n  background-color: #358a66;\r\n}\r\n\r\n.confirm-buttons {\r\n  display: flex;\r\n  justify-content: space-around;\r\n  margin-top: 20px;\r\n}\r\n\r\n.cancel-button {\r\n  background-color: #e74c3c;\r\n}\r\n\r\n.cancel-button:hover {\r\n  background-color: #c0392b;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}