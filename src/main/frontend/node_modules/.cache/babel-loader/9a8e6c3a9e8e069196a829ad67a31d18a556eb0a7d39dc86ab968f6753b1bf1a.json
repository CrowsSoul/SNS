{"ast":null,"code":"import axios from \"@/utils/axios\";\nexport default {\n  name: \"ActivityPreparation\",\n  data() {\n    return {\n      activities: [],\n      user: null,\n      currentPage: 1,\n      activitiesPerPage: 3,\n      showParticipantsModal: false,\n      participants: [],\n      participantCurrentPage: 1,\n      participantsPerPage: 5\n    };\n  },\n  computed: {\n    paginatedActivities() {\n      const start = (this.currentPage - 1) * this.activitiesPerPage;\n      const end = start + this.activitiesPerPage;\n      return this.activities.slice(start, end);\n    },\n    totalPages() {\n      return Math.ceil(this.activities.length / this.activitiesPerPage);\n    },\n    paginatedParticipants() {\n      const start = (this.participantCurrentPage - 1) * this.participantsPerPage;\n      const end = start + this.participantsPerPage;\n      return this.participants.slice(start, end);\n    },\n    participantTotalPages() {\n      return Math.ceil(this.participants.length / this.participantsPerPage);\n    }\n  },\n  methods: {\n    async fetchActivities() {\n      if (!this.user) return;\n      try {\n        const response = await axios.get(\"/activities\");\n        this.activities = response.data.filter(activity => activity.initiator === this.user.nickname);\n      } catch (error) {\n        console.error(\"获取活动列表失败\", error);\n      }\n    },\n    formatDate(timeArray) {\n      const formattedTime = `${timeArray[0]}-${String(timeArray[1]).padStart(2, \"0\")}-${String(timeArray[2]).padStart(2, \"0\")} ${String(timeArray[3]).padStart(2, \"0\")}:${String(timeArray[4]).padStart(2, \"0\")}`;\n      return formattedTime;\n    },\n    viewParticipants(activity) {\n      this.participants = activity.participantList;\n      this.participantCurrentPage = 1;\n      this.showParticipantsModal = true;\n    },\n    closeParticipantsModal() {\n      this.showParticipantsModal = false;\n    },\n    nextPage() {\n      if (this.currentPage < this.totalPages) {\n        this.currentPage++;\n      }\n    },\n    prevPage() {\n      if (this.currentPage > 1) {\n        this.currentPage--;\n      }\n    },\n    nextParticipantPage() {\n      if (this.participantCurrentPage < this.participantTotalPages) {\n        this.participantCurrentPage++;\n      }\n    },\n    prevParticipantPage() {\n      if (this.participantCurrentPage > 1) {\n        this.participantCurrentPage--;\n      }\n    },\n    setMenu() {\n      this.$store.dispatch(\"setActiveSubMenu\", \"activity\");\n    }\n  },\n  created() {\n    const userData = localStorage.getItem(\"user\");\n    if (userData) {\n      this.user = JSON.parse(userData);\n    }\n    this.fetchActivities();\n    this.setMenu();\n  },\n  watch: {\n    $route() {\n      this.setMenu();\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","activities","user","currentPage","activitiesPerPage","showParticipantsModal","participants","participantCurrentPage","participantsPerPage","computed","paginatedActivities","start","end","slice","totalPages","Math","ceil","length","paginatedParticipants","participantTotalPages","methods","fetchActivities","response","get","filter","activity","initiator","nickname","error","console","formatDate","timeArray","formattedTime","String","padStart","viewParticipants","participantList","closeParticipantsModal","nextPage","prevPage","nextParticipantPage","prevParticipantPage","setMenu","$store","dispatch","created","userData","localStorage","getItem","JSON","parse","watch","$route"],"sources":["D:\\Code\\JavaWorkspace\\my-sns\\src\\views\\activity\\user\\ActivityPreparation.vue"],"sourcesContent":["<template>\r\n  <div class=\"activity-preparation\">\r\n    <h1>活动筹备</h1>\r\n    <ul v-if=\"paginatedActivities.length\">\r\n      <li v-for=\"activity in paginatedActivities\" :key=\"activity.id\">\r\n        <h2>{{ activity.name }}</h2>\r\n        <p>时间: {{ formatDate(activity.time) }}</p>\r\n        <p>地点: {{ activity.location }}</p>\r\n        <p>\r\n          报名人数: {{ activity.currentParticipants }}/{{\r\n            activity.maxParticipants\r\n          }}\r\n        </p>\r\n        <div class=\"action-buttons\">\r\n          <router-link\r\n            :to=\"{\r\n              name: 'ActivityDetail',\r\n              params: { id: activity.id },\r\n              query: { from: 'preparation' },\r\n            }\"\r\n            class=\"detail-button\"\r\n            >查看详情</router-link\r\n          >\r\n          <button\r\n            @click=\"viewParticipants(activity)\"\r\n            class=\"participants-button\"\r\n          >\r\n            查看报名情况\r\n          </button>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    <div v-else>\r\n      <p>暂无活动</p>\r\n    </div>\r\n    <div class=\"pagination\" v-if=\"totalPages > 1\">\r\n      <button @click=\"prevPage\" :disabled=\"currentPage === 1\">上一页</button>\r\n      <span>第 {{ currentPage }} 页，共 {{ totalPages }} 页</span>\r\n      <button @click=\"nextPage\" :disabled=\"currentPage === totalPages\">\r\n        下一页\r\n      </button>\r\n    </div>\r\n\r\n    <div v-if=\"showParticipantsModal\" class=\"participants-modal\">\r\n      <div class=\"participants-modal-box\">\r\n        <h2>报名情况</h2>\r\n        <ul v-if=\"paginatedParticipants.length\">\r\n          <li v-for=\"participant in paginatedParticipants\" :key=\"participant\">\r\n            {{ participant }}\r\n          </li>\r\n        </ul>\r\n        <div v-else>\r\n          <p>暂无报名</p>\r\n        </div>\r\n        <div class=\"pagination\" v-if=\"participantTotalPages > 1\">\r\n          <button\r\n            @click=\"prevParticipantPage\"\r\n            :disabled=\"participantCurrentPage === 1\"\r\n          >\r\n            上一页\r\n          </button>\r\n          <span\r\n            >第 {{ participantCurrentPage }} 页，共\r\n            {{ participantTotalPages }} 页</span\r\n          >\r\n          <button\r\n            @click=\"nextParticipantPage\"\r\n            :disabled=\"participantCurrentPage === participantTotalPages\"\r\n          >\r\n            下一页\r\n          </button>\r\n        </div>\r\n        <button @click=\"closeParticipantsModal\" class=\"close-button\">\r\n          关闭\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"@/utils/axios\";\r\n\r\nexport default {\r\n  name: \"ActivityPreparation\",\r\n  data() {\r\n    return {\r\n      activities: [],\r\n      user: null,\r\n      currentPage: 1,\r\n      activitiesPerPage: 3,\r\n      showParticipantsModal: false,\r\n      participants: [],\r\n      participantCurrentPage: 1,\r\n      participantsPerPage: 5,\r\n    };\r\n  },\r\n  computed: {\r\n    paginatedActivities() {\r\n      const start = (this.currentPage - 1) * this.activitiesPerPage;\r\n      const end = start + this.activitiesPerPage;\r\n      return this.activities.slice(start, end);\r\n    },\r\n    totalPages() {\r\n      return Math.ceil(this.activities.length / this.activitiesPerPage);\r\n    },\r\n    paginatedParticipants() {\r\n      const start =\r\n        (this.participantCurrentPage - 1) * this.participantsPerPage;\r\n      const end = start + this.participantsPerPage;\r\n      return this.participants.slice(start, end);\r\n    },\r\n    participantTotalPages() {\r\n      return Math.ceil(this.participants.length / this.participantsPerPage);\r\n    },\r\n  },\r\n  methods: {\r\n    async fetchActivities() {\r\n      if (!this.user) return;\r\n      try {\r\n        const response = await axios.get(\"/activities\");\r\n        this.activities = response.data.filter(\r\n          (activity) => activity.initiator === this.user.nickname\r\n        );\r\n      } catch (error) {\r\n        console.error(\"获取活动列表失败\", error);\r\n      }\r\n    },\r\n    formatDate(timeArray) {\r\n      const formattedTime = `${timeArray[0]}-${String(timeArray[1]).padStart(\r\n        2,\r\n        \"0\"\r\n      )}-${String(timeArray[2]).padStart(2, \"0\")} ${String(\r\n        timeArray[3]\r\n      ).padStart(2, \"0\")}:${String(timeArray[4]).padStart(2, \"0\")}`;\r\n      return formattedTime;\r\n    },\r\n    viewParticipants(activity) {\r\n      this.participants = activity.participantList;\r\n      this.participantCurrentPage = 1;\r\n      this.showParticipantsModal = true;\r\n    },\r\n    closeParticipantsModal() {\r\n      this.showParticipantsModal = false;\r\n    },\r\n    nextPage() {\r\n      if (this.currentPage < this.totalPages) {\r\n        this.currentPage++;\r\n      }\r\n    },\r\n    prevPage() {\r\n      if (this.currentPage > 1) {\r\n        this.currentPage--;\r\n      }\r\n    },\r\n    nextParticipantPage() {\r\n      if (this.participantCurrentPage < this.participantTotalPages) {\r\n        this.participantCurrentPage++;\r\n      }\r\n    },\r\n    prevParticipantPage() {\r\n      if (this.participantCurrentPage > 1) {\r\n        this.participantCurrentPage--;\r\n      }\r\n    },\r\n    setMenu() {\r\n      this.$store.dispatch(\"setActiveSubMenu\", \"activity\");\r\n    },\r\n  },\r\n  created() {\r\n    const userData = localStorage.getItem(\"user\");\r\n    if (userData) {\r\n      this.user = JSON.parse(userData);\r\n    }\r\n    this.fetchActivities();\r\n    this.setMenu();\r\n  },\r\n  watch: {\r\n    $route() {\r\n      this.setMenu();\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.activity-preparation {\r\n  padding: 20px;\r\n  background: #f9f9f9;\r\n  border-radius: 10px;\r\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.activity-preparation h1 {\r\n  text-align: center;\r\n}\r\n\r\nul {\r\n  list-style: none;\r\n  padding: 0;\r\n}\r\n\r\nli {\r\n  background: white;\r\n  padding: 20px;\r\n  margin-bottom: 10px;\r\n  border-radius: 10px;\r\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\nh2 {\r\n  margin: 0;\r\n}\r\n\r\np {\r\n  margin: 10px 0;\r\n}\r\n\r\n.action-buttons {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.detail-button,\r\n.participants-button {\r\n  padding: 10px 20px;\r\n  background-color: #007bff;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  font-size: 16px;\r\n  transition: background 0.3s;\r\n  text-decoration: none; /* 去掉下划线 */\r\n}\r\n\r\n.detail-button:hover,\r\n.participants-button:hover {\r\n  background-color: #0056b3;\r\n}\r\n\r\n.participants-button {\r\n  background-color: #f0ad4e;\r\n}\r\n\r\n.participants-button:hover {\r\n  background-color: #ec971f;\r\n}\r\n\r\n.pagination {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-top: 20px;\r\n}\r\n\r\n.pagination button {\r\n  padding: 10px 20px;\r\n  background-color: #42b983;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 10px;\r\n  cursor: pointer;\r\n}\r\n\r\n.pagination button:hover {\r\n  background-color: #358a66;\r\n}\r\n\r\n.participants-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.8);\r\n  color: white;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.participants-modal-box {\r\n  background: #2c3e50;\r\n  padding: 40px;\r\n  border-radius: 30px;\r\n  text-align: center;\r\n  width: 400px;\r\n  max-height: 80vh;\r\n  overflow-y: auto;\r\n}\r\n\r\n.participants-modal-box h2 {\r\n  margin-top: 0;\r\n}\r\n\r\n.participants-modal-box ul {\r\n  list-style: none;\r\n  padding: 0;\r\n}\r\n\r\n.participants-modal-box li {\r\n  background: white;\r\n  color: black;\r\n  padding: 10px;\r\n  margin-bottom: 10px;\r\n  border-radius: 10px;\r\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.participants-modal-box .pagination {\r\n  margin-top: 10px;\r\n}\r\n\r\n.participants-modal-box .close-button {\r\n  padding: 10px 20px;\r\n  background-color: #e74c3c;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 10px;\r\n  cursor: pointer;\r\n  margin-top: 20px;\r\n}\r\n\r\n.participants-modal-box .close-button:hover {\r\n  background-color: #c0392b;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}